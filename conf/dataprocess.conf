[main]
dp_list = daily_data,hourly_data,rt_data
# dp_list = daily_data

[rt_data]
# module name
# module_name = rt_jsdb_intrusion,rt_qmgr_intrusion,rt_360safe_intrusion,rt_qb_intrusion,rt_sogoue_intrusion,rt_sogouIMEI_intrusion
# module_name = rt_jsdb_intrusion,rt_qmgr_intrusion,rt_360safe_intrusion
module_name = 

# seconds. specify time intervals to fetch data
fetch_intervals = 10

# handle_module. specify module to handle data
handle_module = realtime_etl

[rt_jsdb_intrusion]
fetch_intervals = 30
query_sql = select FROM_UNIXTIME(floor(UNIX_TIMESTAMP(server_time) / 300) * 300, '%%Y-%%m-%%d %%H:%%i:00') as ds, sum(value) as y from realtime_db.rt_safe_realtime_incursion where UNIX_TIMESTAMP(server_time) between floor((UNIX_TIMESTAMP(now())-1800)/300)*300 and UNIX_TIMESTAMP(now()) and type = 'ear10_inst_node_cs' and name = '3,0,1' group by floor(UNIX_TIMESTAMP(server_time) / 300) * 300 order by floor(UNIX_TIMESTAMP(server_time) / 300) * 300 asc

[rt_qmgr_intrusion]
fetch_intervals = 30
query_sql = select FROM_UNIXTIME(floor(UNIX_TIMESTAMP(server_time) / 300) * 300, '%%Y-%%m-%%d %%H:%%i:00') as ds, sum(value) as y from realtime_db.rt_safe_realtime_incursion where UNIX_TIMESTAMP(server_time) between floor((UNIX_TIMESTAMP(now())-1800)/300)*300 and UNIX_TIMESTAMP(now()) and type = 'ear10_inst_node_cs' and name = '2,0,1' group by floor(UNIX_TIMESTAMP(server_time) / 300) * 300 order by floor(UNIX_TIMESTAMP(server_time) / 300) * 300 asc

[rt_360safe_intrusion]
fetch_intervals = 30
query_sql = select FROM_UNIXTIME(floor(UNIX_TIMESTAMP(server_time) / 300) * 300, '%%Y-%%m-%%d %%H:%%i:00') as ds, sum(value) as y from realtime_db.rt_safe_realtime_incursion where UNIX_TIMESTAMP(server_time) between floor((UNIX_TIMESTAMP(now())-1800)/300)*300 and UNIX_TIMESTAMP(now()) and type = 'ear10_inst_node_cs' and name = '1,0,1' group by floor(UNIX_TIMESTAMP(server_time) / 300) * 300 order by floor(UNIX_TIMESTAMP(server_time) / 300) * 300 asc


[daily_data]
at = 8:30
# module_name = daily_safe_dau,daily_safe_odd_index,daily_360safe_intrusion,daily_qmgr_intrusion,daily_jsdb_intrusion
module_name = daily_safe_browser_use,daily_safe_overlap

handle_module = daily_etl

[daily_safe_dau]
at = 10:26

query_sql = select p_dt as ds, daily_active as y from dm_db.dm_product_safe_kpi_day where p_dt = date_sub(curdate(), interval 1 day)

[daily_safe_odd_index]
at = 11:39
query_sql = select data_date as ds, odd_index as y from da_db.scenes_conclusion_info_norm a where scenes_id = 3 and data_date = date_sub(curdate(), interval 1 day)

[daily_360safe_intrusion]
at = 15:49
query_sql = select p_dt as ds, intrusion_cn as y from dm_db.dm_comp_monitor_intrusion_day where p_dt=date_sub(curdate(), interval 1 day) and comp_product = '360安全卫士'


[daily_qmgr_intrusion]
at = 15:49
query_sql = select p_dt as ds, intrusion_cn as y from dm_db.dm_comp_monitor_intrusion_day where p_dt=date_sub(curdate(), interval 1 day) and comp_product = '电脑管家'


[daily_jsdb_intrusion]
at = 15:49
query_sql = select p_dt as ds, intrusion_cn as y from dm_db.dm_comp_monitor_intrusion_day where p_dt=date_sub(curdate(), interval 1 day) and comp_product = '金山毒霸'

[daily_all_overlap]
at = 15:49
query_sql = select p_dt ds, item_json as y from dm_db.dm_common_cover_overlap_install_day where p_dt = date_sub(curdate(), interval 1 day) and product_id = '2345All'

[daily_safe_overlap]
at = 15:49
query_sql = select p_dt ds, product_user_cn_json as y from dm_db.dm_safe_overlap_install_day where p_dt = date_sub(curdate(), interval 1 day)

[daily_safe_browser_use]
at = 15:49
query_sql = select p_dt as ds, concat('{"2345浏览器":', 2345_browser_user_numbers/browser_user_numbers, ',"IE浏览器":', ie_user_numbers/browser_user_numbers, ',"QQ浏览器":', qb_user_numbers/browser_user_numbers, ',"360安全浏览器":', 360se_user_numbers/browser_user_numbers, ',"搜狗浏览器":', sougoue_user_numbers/browser_user_numbers, ',"猎豹浏览器":', liebao_user_numbers/browser_user_numbers, ',"chrome":', chrome_user_numbers/browser_user_numbers,'}') as y from dm_db.dm_product_safe_general_data_add_browser_user_number where p_dt = date_sub(curdate(), interval 1 day) 


[hourly_data]

fetch_intervals = 30

# module_name = hourly_safe_dau,hourly_safe_install,hourly_safe_uninstall
module_name = 

handle_module = hourly_etl

[hourly_safe_dau]
query_sql = select concat(p_dt, ' ', p_hours, ':00:00') as ds, sum(count) as y from dm_db.dm_product_safe_kpi_hour where p_dt = date_format(date_sub(now(), interval 2 hour), '%%Y-%%m-%%d') and p_hours = date_format(date_sub(now(), interval 2 hour), '%%H') and p_type=1

[hourly_safe_install]
query_sql = select concat(p_dt, ' ', p_hours, ':00:00') as ds, sum(count) as y from dm_db.dm_product_safe_kpi_hour where p_dt = date_format(date_sub(now(), interval 2 hour), '%%Y-%%m-%%d') and p_hours = date_format(date_sub(now(), interval 2 hour), '%%H') and p_type=0

[hourly_safe_uninstall]
query_sql = select concat(p_dt, ' ', p_hours, ':00:00') as ds, sum(count) as y from dm_db.dm_product_safe_kpi_hour where p_dt = date_format(date_sub(now(), interval 2 hour), '%%Y-%%m-%%d') and p_hours = date_format(date_sub(now(), interval 2 hour), '%%H') and p_type=2